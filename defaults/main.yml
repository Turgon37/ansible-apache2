---
# Apache2 web server configuration
# --------------------------------

# Enable facts deploiement
apache2__facts: True

# The name of the apache2 package
apache2__packages_names:
  - apache2


### SERVICE CONFIGURATION
# ---------------------------------------
# The name of the systemd mariadb service
apache2__service_name: apache2

# If true the mariadb service will be started and enabled
apache2__service_enabled: True

# If this is set to true, ansible will automatically restart mariadb daemon on changes
apache2__service_restartable: True

# Path to the must restart stamp file
apache2__service_restart_stamp_file: '/var/local/apache2-must-restart-stamp'

# Path to systemd override directory
apache2__systemd_override_options_dir: '/etc/systemd/system/{{ apache2__service_name }}.service.d'

# Enable systemd private tmp
apache2__service_private_tmp: True

# Command to use for template validation
apache2__configuration_validator: "/usr/bin/env bash -c 'source {{ apache2__server_root }}/envvars && apache2 -t -f %s'"

# Service user configuration
apache2__user_runas: www-data
apache2__group_runas: www-data


### GENERAL CONFIGURATION
# ---------------------------------------
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
apache2__server_root: /etc/apache2

# The main apache configuration file
apache2__main_configuration_file: '{{ apache2__server_root }}/apache2.conf'
apache2__ports_configuration_file: '{{ apache2__server_root }}/ports.conf'

# This directory contains symbolic links of enabled modules
apache2__enabled_modules_include_directory: '{{ apache2__server_root }}/mods-enabled'
# This directory contains configuration of available modules
apache2__available_modules_include_directory: '{{ apache2__server_root }}/mods-available'

# This directory contains symbolic links of enabled sites
apache2__available_sites_include_directory: '{{ apache2__server_root }}/sites-available'
# This directory contains configuration of available sites
apache2__enabled_sites_include_directory: '{{ apache2__server_root }}/sites-enabled'


# PidFile: The file in which the server should record its process
# identification number when it starts.
# This needs to be set in /etc/apache2/envvars
apache2__pidfile: /var/run/apache2/apache2.pid

# The accept serialization lock file MUST BE STORED ON A LOCAL DISK.
apache2__mutex_directory: /var/lock/apache2


### LOGGING CONFIGURATION
# ---------------------------------------
# The main apache log directory
apache2__log_directory: /var/log/apache2

# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a <VirtualHost>
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a <VirtualHost>
# container, that host's errors will be logged there and not here.
apache2__error_log: '{{ apache2__log_directory }}/error.log'

# LogLevel: Control the severity of messages logged to the error_log.
# Available values: trace8, ..., trace1, debug, info, notice, warn,
# error, crit, alert, emerg.
apache2__error_log_level: warn
# It is also possible to configure the log level for particular modules
# Set a value for each tuple [module name]: [logging level]
apache2__error_log_level_per_module: {}

# The following directives define some format nicknames for use with
# a CustomLog directive.
#
# These deviate from the Common Log Format definitions in that they use %O
# (the actual bytes sent including headers) instead of %b (the size of the
# requested file), because the latter makes it impossible to detect partial
# requests.
#
# Note that the use of %{X-Forwarded-For}i instead of %h is not recommended.
# Use mod_remoteip instead.
# List of log formats
apache2__log_formats:
  vhost_combined: '%v:%p %h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"'
  combined: '%h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"'
  common: '%h %l %u %t \"%r\" %>s %O'
  referer: '%{Referer}i -> %U'
  agent: '%{User-agent}i'

# Default log format
apache2__log_format: combined


### SERVER VISIBILITY
# ---------------------------------------
# Email address that the server includes in error messages sent to the client
apache2__serveradmin: root@localhost

# Configures the Server HTTP response header
apache2__server_tokens: Prod

# Configures the footer on server-generated documents
apache2__server_signature: False
# Determines the behaviour on TRACE requests
apache2__trace_enable: False


### NETWORK CONFIGURATION
# ---------------------------------------
# List of ports on which to listen for http connexion
apache2__listen_http:
  - 80

# List of ports on which to listen for https connexion
apache2__listen_https:
  - 443

# KeepAlive: Whether or not to allow persistent connections (more than
# one request per connection). Set to "Off" to deactivate.
apache2__keepalive: True

# MaxKeepAliveRequests: The maximum number of requests to allow
# during a persistent connection. Set to 0 to allow an unlimited amount.
# We recommend you leave this number high, for maximum performance.
apache2__max_keepalive_requests: 100

# Timeout: The number of seconds before receives and sends time out.
apache2__timeout: 300

# KeepAliveTimeout: Number of seconds to wait for the next request from the
# same client on the same connection.
apache2__keepalived_timeout: 5

# HostnameLookups: Log the names of clients or just their IP addresses
# e.g., www.apache.org (on) or 204.62.129.132 (off).
apache2__hostname_lookups: False

# List of enabled ssl protocols
apache2__ssl_protocols: All -SSLv2 -SSLv3

# Default list of ciphers
apache2__ssl_ciphers: ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA

apache2__ssl_honorciphers: True


### DIRECTORY CONFIGURATION
# ---------------------------------------
apache2__allow_override: None
apache2__allow_override_list: None
apache2__options: None

# AccessFileName: The name of the file to look for in each directory
# for additional configuration directives.  See also the AllowOverride
# directive.
apache2__access_filename: .htaccess

# List of directives sections name that can be applied to server/vhost level
apache2__server_level_context_directives_name:
  - server_admin
  - document_root
  - error_log
  - custom_log

# Default sections of the root of the configuration
apache2__default_sections:
  # Sets the default security model of the Apache2 HTTPD server.
  - type: directory
    path: /
    directives:
      - options: '{{ apache2__options }}'
      - allow_override: '{{ apache2__allow_override }}'
      - allow_override_list: '{{ apache2__allow_override_list }}'
      - require: all denied
  # The following lines prevent .htaccess and .htpasswd files from being
  # viewed by Web clients.
  - type: files_match
    regex: '^\.ht'
    directives:
      - require: all denied

## Apache modules
# This variable is intended to be used in Ansible’s global inventory.
apache2__global_mods_enabled: {}

# This variable is intended to be used in a host inventory group of Ansible
# (only one host group is supported).
apache2__group_mods_enabled: {}

# This variable is intended to be used in the inventory of hosts.
apache2__host_mods_enabled: {}

# Combine all enabled mods
apache2__mods_enabled: '{{ apache2__global_mods_enabled
                     |combine(apache2__group_mods_enabled)
                     |combine(apache2__host_mods_enabled) }}'

## Apache vhost
# If true, all virtual hosts that are not in apache2__virtual_hosts
# will be removed
apache2__purge_virtual_hosts: True

# This variable is intended to be used in Ansible’s global inventory.
apache2__global_virtual_hosts: {}

# This variable is intended to be used in a host inventory group of Ansible
# (only one host group is supported).
apache2__group_virtual_hosts: {}

# This variable is intended to be used in the inventory of hosts.
apache2__host_virtual_hosts: {}
#apache2__host_virtual_hosts:
  #000-default:
    #server_name: www.example.com
    #server_admin: webmaster@localhost
    #document_root: /var/www/html
    #sections:
      #- type: directory
        #path: /var/www/html
        #directives:
          #- require: all granted
    #error_log: '{{ apache2__log_directory }}/error.log'
    #custom_log: '{{ apache2__log_directory }}/access.log combined'

# Combned vhosts dicts
apache2__virtual_hosts: '{{ apache2__global_virtual_hosts
                     |combine(apache2__group_virtual_hosts)
                     |combine(apache2__host_virtual_hosts) }}'
